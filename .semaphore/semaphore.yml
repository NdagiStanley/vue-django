version: v1.0
name: Docker - Docker Hub | Heroku
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804

blocks:
  - name: "Run scaffolding and test it"
    task:
      jobs:
      - name: run scaffolding
        commands:
          - checkout
          - sudo apt-get update

  - name: "Build & Test Docker image"
    task:
      jobs:
      - name: Docker build & test
        commands:
          - checkout
          - ls -1
          - docker -v
          - echo "Docker build..."
          - echo "Docker test..."
          - echo "done"

  - name: "Push & Deploy"
    task:
      jobs:
      - name: Push to Docker Hub
        commands:
          - echo "Docker Hub"

      - name: Deploy on Heroku
        commands:
          - heroku -v
